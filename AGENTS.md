
# âš¡ META-RULES (æœ€é«˜ä¼˜å…ˆçº§)
1. **è§„åˆ™è¦†ç›–**ï¼šå½“æœ¬é¡¹ç›®çš„ç¼–ç è§„èŒƒä¸ AI çš„é»˜è®¤è¡Œä¸ºåå¥½å†²çªæ—¶ï¼Œ**ä»¥æœ¬é¡¹ç›®è§„èŒƒä¸ºå‡†**ã€‚
2. **é˜»æ–­æœºåˆ¶**ï¼šå½“ç”¨æˆ·æåŠ"å·¥ä½œæµç¨‹"ã€"æŒ‰æµç¨‹æ¥"ç­‰å…³é”®è¯ï¼Œæˆ–ä»»åŠ¡æ¶‰åŠæ–°åŠŸèƒ½å¼€å‘/é‡å¤§é‡æ„æ—¶ï¼Œ**å¿…é¡»**å…ˆé˜…è¯»å¹¶æ‰§è¡Œå·¥ä½œæµç¨‹æ–‡æ¡£ã€‚
3. **è¯­è¨€é”å®š**ï¼šæ— è®ºç”¨æˆ·ä½¿ç”¨ä½•ç§è¯­è¨€æé—®ï¼Œ**å¿…é¡»** ä½¿ç”¨ä¸­æ–‡è¿›è¡Œæ€è€ƒå’Œå›ç­”ï¼ˆä»£ç æ³¨é‡Šé™¤å¤–ï¼‰ã€‚
4. **TDD å¼ºåˆ¶**ï¼šæ‰€æœ‰**çº¯é€»è¾‘ã€å·¥å…·å‡½æ•°å’Œæ•°æ®å¤„ç†**ä»£ç å¿…é¡»éµå¾ª TDD æµç¨‹ï¼›æ¶‰åŠ GPU/æ¨¡å‹/ç¡¬ä»¶ç­‰å¼ºå¤–éƒ¨ä¾èµ–çš„ä»£ç ï¼Œéœ€ç¼–å†™å¯è¡Œçš„é›†æˆæµ‹è¯•æˆ–æ‰‹åŠ¨æµ‹è¯•è®¡åˆ’ã€‚

## ğŸ§ª TDD å¼€å‘åŸåˆ™ (MANDATORY - æœ€é«˜ä¼˜å…ˆçº§)

> âš ï¸ **æµ‹è¯•é©±åŠ¨å¼€å‘æ˜¯æœ¬é¡¹ç›®çš„å¼ºåˆ¶å¼€å‘æ–¹æ³•è®ºã€‚æ‰€æœ‰æ–°åŠŸèƒ½å’Œ bug ä¿®å¤éƒ½å¿…é¡»ä¸¥æ ¼éµå¾ªï¼Œæ— ä¾‹å¤–ã€‚**

### æ ¸å¿ƒæµç¨‹
1. **ğŸ”´ Red**ï¼šå…ˆç¼–å†™å¤±è´¥çš„æµ‹è¯•ï¼Œæ˜ç¡®æœŸæœ›è¡Œä¸ºã€‚æµ‹è¯•å¿…é¡»èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œä¸”åˆå§‹çŠ¶æ€ä¸ºå¤±è´¥ã€‚
2. **ğŸŸ¢ Green**ï¼šç¼–å†™**æœ€å°‘é‡**ä»£ç ä½¿æµ‹è¯•é€šè¿‡ã€‚ä¸åšè¿‡åº¦è®¾è®¡ï¼Œåªæ»¡è¶³å½“å‰æµ‹è¯•éœ€æ±‚ã€‚
3. **ğŸ”µ Refactor**ï¼šåœ¨æµ‹è¯•ä¿æŠ¤ä¸‹ä¼˜åŒ–ä»£ç ç»“æ„ã€‚ç¡®ä¿é‡æ„åæ‰€æœ‰æµ‹è¯•ä»ç„¶é€šè¿‡ã€‚

### TDD ç¦ä»¤
- **ä¸¥ç¦**ï¼šåœ¨æ²¡æœ‰å¯¹åº”æµ‹è¯•çš„æƒ…å†µä¸‹ç¼–å†™çº¯é€»è¾‘/å·¥å…·ç±»æ–°åŠŸèƒ½ä»£ç ï¼ˆæ¶‰åŠç¡¬ä»¶ä¾èµ–çš„ä»£ç éœ€æä¾›æ‰‹åŠ¨æµ‹è¯•è®¡åˆ’ï¼‰ã€‚
- **ä¸¥ç¦**ï¼šå…ˆå†™å®ç°ä»£ç å†è¡¥æµ‹è¯•ï¼ˆäº‹åè¡¥æµ‹è¯•ä¸æ˜¯ TDDï¼‰ã€‚
- **ä¸¥ç¦**ï¼šä¸ºäº†é€šè¿‡æµ‹è¯•è€Œä¿®æ”¹æµ‹è¯•æœ¬èº«ï¼ˆé™¤éæµ‹è¯•é€»è¾‘ç¡®å®æœ‰è¯¯ï¼‰ã€‚
- **ä¸¥ç¦**ï¼šè·³è¿‡ Refactor é˜¶æ®µï¼ˆæŠ€æœ¯å€ºåŠ¡çš„ä¸»è¦æ¥æºï¼‰ã€‚

### TDD æ£€æŸ¥ç‚¹
- æ¯ä¸ª PR/æäº¤å¿…é¡»åŒ…å«å¯¹åº”çš„æµ‹è¯•ä»£ç ã€‚
- æµ‹è¯•è¦†ç›–ç‡ä¸å¾—å› æ–°ä»£ç è€Œä¸‹é™ã€‚
- æµ‹è¯•å¿…é¡»æ˜¯**è¡Œä¸ºæµ‹è¯•**è€Œé**å®ç°æµ‹è¯•**ï¼ˆæµ‹è¯•"åšä»€ä¹ˆ"è€Œé"æ€ä¹ˆåš"ï¼‰ã€‚

## ğŸ“‹ å·¥ä½œæµç¨‹ (MANDATORY)

**å½“å·¥ä½œæµç¨‹è¢«è§¦å‘æ—¶ï¼ˆå‚è§ META-RULES ç¬¬2æ¡ï¼‰ï¼Œåœ¨æ‰§è¡Œä»»ä½• [ä»£ç ä¿®æ”¹] æˆ– [é‡æ„ä»»åŠ¡] ä¹‹å‰ï¼Œä½ å¿…é¡»æ‰§è¡Œä»¥ä¸‹åŠ¨ä½œï¼š**

1. ğŸ›‘ **HALT**ï¼šåœæ­¢æ‰€æœ‰ä»£ç ç¼–å†™æ„å›¾ã€‚
2. ğŸ“– **READ**ï¼šä½¿ç”¨ `read` å·¥å…·è¯»å– @docs/dev/process/workflow.mdã€‚
3. âœ… **CHECK**ï¼šä¸¥æ ¼æŒ‰ç…§ @docs/dev/process/workflow.md ä¸­çš„ Checklists é€é¡¹æ‰§è¡Œï¼ˆåˆ‡åˆ†æ”¯ -> å†™è®¡åˆ’ -> è·æ‰¹å‡† -> ç¼–ç ï¼‰ã€‚

> **è¿è§„è­¦å‘Š**ï¼šåœ¨è§¦å‘å·¥ä½œæµç¨‹çš„æƒ…å†µä¸‹ï¼Œæœªè¯»å– @docs/dev/process/workflow.md è€Œç›´æ¥ä¿®æ”¹ä»£ç å°†è¢«è§†ä¸ºä¸¥é‡è¿è§„ã€‚

## C++ 20 å¼€å‘è§„èŒƒ
- **æ ‡å‡†ä¸æ¨¡å—**ï¼šå¼ºåˆ¶ C++20ã€‚ä½¿ç”¨æ¨¡å—åŒ–ï¼ˆ`.ixx`/`.cppm` æ¥å£ï¼Œ`.cpp` å®ç°ï¼‰æ›¿ä»£ä¼ ç»Ÿå¤´æ–‡ä»¶ã€‚
- **æ„å»ºå·¥å…·** (`python build.py`)ï¼š
  - æ ¸å¿ƒæŒ‡ä»¤ï¼š`--action {configure,build,test,install,package}`
  - **å¼€å‘é˜¶æ®µå¿…é¡»ä½¿ç”¨ Debug æ¨¡å¼**ï¼š`python build.py` (é»˜è®¤é…ç½®ä¸º Debug)
  - Release æ¨¡å¼ä»…ç”¨äºæœ€ç»ˆå‘å¸ƒéªŒè¯
  - äºŒè¿›åˆ¶è¾“å‡ºè·¯å¾„ (Debug): `build/bin/<preset>` (ä¾‹å¦‚ Windows ä¸‹ä¸º `build/bin/msvc-x64-debug`ï¼ŒLinux ä¸‹ä¸º `build/bin/linux-x64-debug`)
  - **è¿è¡Œè¦æ±‚**ï¼šç¦æ­¢åœ¨é¡¹ç›®æ ¹ç›®å½•ç›´æ¥è¿è¡Œç¨‹åºã€‚è¿è¡Œç¨‹åºæ—¶ï¼Œå·¥ä½œç›®å½•ï¼ˆ`Cwd`ï¼‰**å¿…é¡»**è®¾ç½®ä¸ºå¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºç›®å½•ï¼ˆå¦‚ `build/bin/<preset>`ï¼‰ï¼Œä»¥ç¡®ä¿ç›¸å¯¹è·¯å¾„èµ„æºåŠ è½½æ­£ç¡®ï¼Œé˜²æ­¢é‡å¤ä¸‹è½½èµ„æºä»¥åŠ TensorRT å¼•æ“é‡æ–°æ„å»ºã€‚
  - ğŸš¨ **è¯¦ç»†ç”¨æ³• (å¿…è¯»)**ï¼š@docs/build.md â€”â€” **è¯·åŠ¡å¿…é˜…è¯»ä»¥é¿å…ç¯å¢ƒé…ç½®é”™è¯¯**
- **è´¨é‡æ§åˆ¶**ï¼š
  - æ ¼å¼åŒ–ï¼š`python scripts/format_code.py`
  - é™æ€åˆ†æï¼š`python scripts/run_clang_tidy.py` (Windows + MSVC ç¯å¢ƒä¸‹è·³è¿‡)
  - æäº¤å‰æ£€æŸ¥ï¼š`python scripts/pre_commit_check.py` (å¼ºçƒˆå»ºè®®åœ¨ commit å‰è¿è¡Œ)
- **å¼€å‘åŸåˆ™**ï¼š
  - **æ™ºèƒ½æŒ‡é’ˆä¼˜å…ˆäºè£¸æŒ‡é’ˆ**ã€‚
  - **RAII**ã€‚
  - **PIMPL**ã€‚
  - **ç»„åˆä¼˜äºç»§æ‰¿**ã€‚
  - **é¿å…ä½¿ç”¨å…¨å±€å˜é‡**ã€‚
- **æ¨¡å—å¼€å‘å†›è§„**ï¼š
  1. **è®¾è®¡æ¨¡å¼**ï¼šæ ¹æ®åœºæ™¯éœ€è¦é€‰æ‹©åˆé€‚çš„è®¾è®¡æ¨¡å¼ï¼ˆå¦‚å·¥å‚ã€ç­–ç•¥ã€è§‚å¯Ÿè€…ç­‰ï¼‰ï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚
  2. **ç‰©ç†ä¾èµ–**ï¼šåœ¨ `CMakeLists.txt` ä¸­ï¼Œ`FILE_SET cxx_modules` å¿…é¡»åŒ…å«æ‰€æœ‰ `.ixx`ï¼Œä¸”é¡ºåºæ­£ç¡®ï¼ˆä¾èµ–æ–¹åœ¨åï¼‰ã€‚

## é¡¹ç›®ç®¡ç†è§„èŒƒ
- **åˆ†æ”¯ç­–ç•¥**ï¼š
  - **ä¸¥ç¦ç›´æ¨ä¸»åˆ†æ”¯**ã€‚
  - **æµç¨‹**ï¼šåŸºäºä¸»åˆ†æ”¯(master æˆ– {os_name}/dev)æ–°å»º -> å®ç°ä¸æµ‹è¯• -> éªŒæ”¶é€šè¿‡ -> åˆå¹¶ä¸»åˆ†æ”¯å¹¶åˆ é™¤ã€‚
  - **å‘½å**ï¼š`feature/plan-{name}` æˆ– `fix/task-{name}`ã€‚
- **æ–‡æ¡£ç®¡ç†** (`/docs/dev/`)ï¼š
  - è®¡åˆ’ï¼š`plan/{name}/C++_plan_{title}.md` (ä½¿ç”¨ `@docs/dev/templates/C++_plan_template.md`)
  - ä»»åŠ¡ï¼š`plan/{name}/task/C++_task_{title}.md` (ä½¿ç”¨ `@docs/dev/templates/C++_task_template.md`)
  - è¯„ä¼°ï¼š`evaluation/C++_evaluation_{title}.md` (ä½¿ç”¨ `@docs/dev/templates/C++_evaluation_template.md`)
  - è®°å½•ï¼š`@docs/dev/C++_troubleshooting.md` (è®°å½•ç–‘éš¾æ‚ç—‡, ä½¿ç”¨ `@docs/dev/C++_troubleshooting.md`)
- **æäº¤è¦æ±‚**ï¼š
  - ä»…æäº¤æºç ä¸å¿…è¦èµ„æºï¼Œç¦æ­¢æäº¤æ–‡æ¡£ã€æ—¥å¿—æˆ–æ„å»ºæ–‡ä»¶(é™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚)ã€‚
  - æäº¤æ–‡æ¡£ç›¸å…³æ–‡ä»¶æ—¶è·³è¿‡ç¼–è¯‘æµ‹è¯•éªŒè¯ã€‚
  - æ–‡ä»¶é‡å‘½å/ç§»åŠ¨å¿…é¡»ä½¿ç”¨ `git mv`ã€‚
  - æäº¤å‰å¿…é¡»é€šè¿‡ `python build.py --action test --test-label unit`ã€‚
  - **æµ‹è¯•èŒè´£åˆ’åˆ†**ï¼šæ™ºèƒ½ä½“/AI ä»…éœ€è¿è¡Œå•å…ƒæµ‹è¯•ï¼›é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ç”±ç”¨æˆ·æ‰‹åŠ¨éªŒè¯ã€‚

## â›” ç»å¯¹ç¦ä»¤ (Violations trigger STOP)
- **ç›´æ¥åœ¨ä¸»åˆ†æ”¯å¼€å‘**ï¼šæ£€æµ‹åˆ° `git status` ä¸º `{os_name}/dev` æˆ– `master` æ—¶ä¿®æ”¹ä»£ç ã€‚
- **æ— æ–‡æ¡£å³ä»£ç **ï¼šåœ¨æœªåˆ›å»º/æ›´æ–° `docs/` ä¸‹å¯¹åº”æ–‡æ¡£å‰ç¼–å†™ä¸šåŠ¡ä»£ç ï¼ˆå°å‹ bug ä¿®å¤ < 20è¡Œæ”¹åŠ¨ å’ŒéåŠŸèƒ½æ€§å˜æ›´å¯è±å…ï¼‰ã€‚
- **æ— æµ‹è¯•å³æäº¤**ï¼šåœ¨æœªè¿è¡Œ `python build.py --action test --test-label unit` å¹¶æˆªå›¾/è´´å‡ºæ—¥å¿—å‰è¿›è¡Œ git commitï¼ˆæ–‡æ¡£/æ³¨é‡Šç­‰éä»£ç ç±»å˜æ›´åŠ `docs/` ç›®å½•ä¸‹å†…å®¹é™¤å¤–ï¼‰ã€‚
- **å¹»è§‰å¼•ç”¨**ï¼šå¼•ç”¨ä¸å­˜åœ¨çš„æ–‡ä»¶è·¯å¾„ï¼ˆå¿…é¡»å…ˆ `ls` æˆ– `glob` ç¡®è®¤æ–‡ä»¶å­˜åœ¨ï¼‰ã€‚
- **ä¸¥ç¦é€’å½’åˆ é™¤** `build` ç›®å½•åŠå…¶å­æ–‡ä»¶ã€‚
- **ä¸¥ç¦æäº¤** æœªé€šè¿‡ç¼–è¯‘æˆ–åŸºç¡€æµ‹è¯•çš„ä»£ç ã€‚
- **è°¨æ…ä½¿ç”¨ `--clean` å‚æ•°**ï¼š`--clean` ä»…æ¸…ç†ä¸­é—´æ„å»ºæ–‡ä»¶ï¼Œbin ç›®å½•å’Œ TensorRT ç¼“å­˜ä¼šè¢«ä¿ç•™ã€‚åœ¨ä¸ç¡®å®šå½±å“æ—¶è¯·å…ˆç¡®è®¤ã€‚
