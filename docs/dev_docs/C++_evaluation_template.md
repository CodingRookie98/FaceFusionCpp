# C++ 代码质量评估报告

> **标准参考**:
> *   评估标准与工具指南请参考: [C++代码质量与评估标准指南](./C++_quality_standard.md)
> *   模块化最佳实践请参考: [C++20 Modules 大型工程实践](../C++/C++_20_模块-大型工程实践.md)

## 1. 评估概述

### 1.1 评估目标
> @brief 明确本次评估的主要目标和预期成果

- [ ] {评估目标1}
- [ ] {评估目标2}

### 1.2 评估对象信息

| 属性 | 内容 |
| :--- | :--- |
| **模块名称** | `{模块名称}` |
| **代码路径** | `{代码路径}` |
| **C++标准** | C++20 |
| **构建工具** | CMake + MSVC/Ninja |
| **负责人** | `{负责人}` |

---

## 2. 模块化与架构评估 (权重: 60%)

### 2.1 模块架构分析 (权重 20%)
> **标准**: "多模块聚合单库"原则。Library Target 数量应克制，Module 数量可细化。

| 检查项 | 评分点 | 状态 | 说明/证据 |
| :--- | :--- | :--- | :--- |
| **构建粒度** | 避免"一模块一 Target" | ✅ / ⚠️ / ❌ | 检查 CMakeLists.txt 是否聚合了多个 .ixx 到一个 add_library |
| **分层架构** | 5层模型符合性 | ✅ / ⚠️ / ❌ | App -> Services -> Domain -> Platform -> Foundation |
| **模块分类** | 模块类型正确 | ✅ / ⚠️ / ❌ | Public / Internal / Test 区分清晰 |
| **2层模型** | Logical vs Physical | ✅ / ⚠️ / ❌ | 逻辑模块与物理库的映射是否合理 |

### 2.2 接口设计与 BMI 优化 (权重 30%)
> **标准**: `.ixx` 仅包含声明，`.cpp` 包含实现。修改 `.cpp` 不应触发下游重编。

| 检查项 | 评分点 | 状态 | 说明/证据 |
| :--- | :--- | :--- | :--- |
| **接口纯度** | 接口与实现分离 | ✅ / ⚠️ / ❌ | `.ixx` 中是否存在非模板函数的函数体？ |
| **GMF 使用** | 第三方库隔离 | ✅ / ⚠️ / ❌ | `#include` 是否放在 `module;` ... `export module` 之间？ |
| **BMI 优化** | 增量构建友好 | ✅ / ⚠️ / ❌ | 修改 .cpp 是否触发了不必要的重编？ |
| **接口文档** | 完整性 | ✅ / ⚠️ / ❌ | 导出的类/函数是否有 Doxygen 注释？ |

### 2.3 依赖分析 (权重 10%)

| 检查项 | 评分点 | 状态 | 说明/证据 |
| :--- | :--- | :--- | :--- |
| **依赖单向性** | 无反向依赖 | ✅ / ⚠️ / ❌ | 底层模块不依赖高层模块 |
| **循环依赖** | 无循环引用 | ✅ / ⚠️ / ❌ | Ninja/CMake 未报告 Cycle |
| **依赖清晰度** | 依赖矩阵完整 | ✅ / ⚠️ / ❌ | 依赖关系是否直观清晰 |

**典型违规代码片段 (如有)**:
```cpp
// 粘贴发现的违规代码，如在 .ixx 中直接写了实现
```

---

## 3. 代码质量与规范评估 (权重: 30%)

### 3.1 代码风格与规范 (权重 10%)
> **参考**: 原 C++_code_style.md 规范

| 检查项 | 规范要求 | 状态 | 说明/证据 |
| :--- | :--- | :--- | :--- |
| **命名规范** | `snake_case` | ✅ / ⚠️ / ❌ | 变量、函数、命名空间使用蛇形命名 |
| **成员变量** | `m_` 前缀 + `snake_case` | ✅ / ⚠️ / ❌ | 类成员变量需带 `m_` 前缀 |
| **注释风格** | Doxygen 风格 | ✅ / ⚠️ / ❌ | 核心接口使用 `/// @brief` 等标签 |
| **格式化** | Clang-Format | ✅ / ⚠️ / ❌ | 代码是否经过格式化工具处理 |

### 3.2 安全性与现代化 (权重 20%)

| 检查项 | 评分点 | 状态 | 说明/证据 |
| :--- | :--- | :--- | :--- |
| **内存安全** | RAII / 智能指针 | ✅ / ⚠️ / ❌ | 禁止裸 `new/delete`，优先使用 `std::unique_ptr` |
| **资源管理** | Rule of 5 | ✅ / ⚠️ / ❌ | 需自定义析构函数的类是否正确处理了拷贝/移动语义 |
| **现代特性** | C++20 特性使用 | ✅ / ⚠️ / ❌ | 是否使用了 Concepts, Ranges, Modules 等新特性 |
| **线程安全** | 并发控制 | ✅ / ⚠️ / ❌ | 多线程访问是否有锁或原子操作保护 |
| **异常安全** | 异常保证 | ✅ / ⚠️ / ❌ | 关键路径是否提供了基本或强异常保证 |

---

## 4. 测试与性能评估 (权重: 10%)

### 4.1 测试隔离与覆盖 (权重 5%)

| 检查项 | 评分点 | 状态 | 说明 |
| :--- | :--- | :--- | :--- |
| **测试隔离** | 独立模块 | ✅ / ❌ | 生产代码是否零依赖于测试代码？ |
| **测试辅助** | `test_support` | ✅ / ❌ | 测试辅助工具是否独立封装？ |
| **测试覆盖** | 覆盖率 | {数值}% | 单元测试覆盖率情况 |

### 4.2 性能评估 (权重 5%)

| 检查项 | 评分点 | 状态 | 说明 |
| :--- | :--- | :--- | :--- |
| **编译性能** | 编译时间 | ✅ / ⚠️ | BMI 生成和编译速度是否在可接受范围？ |
| **运行时性能**| 关键路径 | ✅ / ⚠️ | 是否有明显的性能瓶颈？ |

---

## 5. 评估结论与评分

### 5.1 评分汇总表
> 评分计算请参考 [C++质量标准指南](../C++_quality_standard.md#2-评分标准)

| 评估维度 | 权重 | 得分 (0-100) | 加权分 | 简评 |
| :--- | :--- | :--- | :--- | :--- |
| **模块化与架构** | 60% | | | {简述} |
| **代码质量与规范** | 30% | | | {简述} |
| **测试与性能** | 10% | | | {简述} |
| **总分** | **100%** | | **{总分}** | **{等级: 优秀/良好/合格/待改进}** |

### 5.2 改进计划 (Action Items)

**必须修复 (Blocker)**:
- [ ] {任务1}

**建议优化 (Nice to have)**:
- [ ] {任务2}

---
**评估人**: {姓名}
**日期**: {YYYY-MM-DD}
