# C++ 代码质量评估报告

> **标准参考**:
> *   评估标准与工具指南请参考: [C++代码质量与评估标准指南](./C++_quality_standard.md)
> *   模块化最佳实践请参考: [C++20 Modules 大型工程实践](../C++/C++_20_模块-大型工程实践.md)

## 1. 评估概述

### 1.1 评估目标
> @brief 明确本次评估的主要目标和预期成果

- [ ] {评估目标1}
- [ ] {评估目标2}

### 1.2 评估对象信息

| 属性 | 内容 |
| :--- | :--- |
| **模块名称** | `{模块名称}` |
| **代码路径** | `{代码路径}` |
| **C++标准** | C++20 |
| **构建工具** | CMake + MSVC/Ninja |
| **负责人** | `{负责人}` |

---

## 2. 核心架构评估 (Critical)

### 2.1 模块与构建粒度
> **标准**: "多模块聚合单库"原则。Library Target 数量应克制，Module 数量可细化。

| 检查项 | 状态 | 说明/证据 |
| :--- | :--- | :--- |
| **构建粒度** | ✅ / ⚠️ / ❌ | 是否避免了"一模块一 Target"？(检查 CMakeLists.txt 是否聚合了多个 .ixx 到一个 add_library) |
| **分层架构** | ✅ / ⚠️ / ❌ | 是否符合 App -> Services -> Domain -> Platform -> Foundation 分层？ |
| **命名规范** | ✅ / ⚠️ / ❌ | 文件名是否符合 `.ixx` (Interface) / `.cpp` (Impl) 规范？ |

### 2.2 接口与实现分离 (BMI 优化)
> **标准**: `.ixx` 仅包含声明，`.cpp` 包含实现。修改 `.cpp` 不应触发下游重编。

| 检查项 | 状态 | 说明/证据 |
| :--- | :--- | :--- |
| **接口纯度** | ✅ / ⚠️ / ❌ | `.ixx` 中是否存在非模板函数的函数体？ |
| **依赖隔离** | ✅ / ⚠️ / ❌ | 是否避免了在接口中 `export import` 大型头文件？ |
| **GMF 使用** | ✅ / ⚠️ / ❌ | 第三方库 (`fmt`, `boost` 等) 是否放在 `module;` ... `export module` 之间？ |

**典型违规代码片段 (如有)**:
```cpp
// 粘贴发现的违规代码，如在 .ixx 中直接写了实现
```

---

## 3. 依赖分析

### 3.1 依赖可视化
> 建议运行 `cmake --graphviz=deps.dot .` 生成依赖图。

```mermaid
graph LR
    %% 在此粘贴 Mermaid 依赖图，或手绘关键依赖路径
    module1[{module1}] --> module2[{module2}]
    module2 --> module3[{module3}]
    test_module1[test.module1] -.-> module1
```

### 3.2 依赖健康度

| 检查项 | 状态 | 说明 |
| :--- | :--- | :--- |
| **循环依赖** | ✅ / ❌ | 是否存在 Ninja/CMake 报告的循环依赖？ |
| **反向依赖** | ✅ / ❌ | 是否存在底层模块依赖高层模块的情况？ |
| **测试隔离** | ✅ / ❌ | 生产代码是否**零依赖**于 `test_support` 或测试代码？ |

---

## 4. 测试与质量

### 4.1 测试覆盖

| 测试类型 | 覆盖状态 | 说明 |
| :--- | :--- | :--- |
| **单元测试** | {覆盖率/覆盖范围} | 是否每个逻辑模块都有对应的 `test_*.exe`？ |
| **测试辅助** | {是否分离} | 测试辅助代码是否封装在 `test_support` 模块中？ |

### 4.2 代码质量 (Clang-Tidy / CppCheck)

*   [ ] **无高危警告** (Level 1)
*   [ ] **内存安全** (RAII, 智能指针使用正确)
*   [ ] **并发安全** (无显而易见的数据竞争)

**主要问题记录**:
1.  {问题描述}
2.  {问题描述}

---

## 5. 评估结论与评分

### 5.1 评分摘要
> 评分标准参考 [C++质量标准指南](../C++_quality_standard.md#2-评分标准)

| 评估维度 | 等级 (S/A/B/C) | 简评 |
| :--- | :--- | :--- |
| **模块化架构** | - | {粒度、分层、命名} |
| **BMI/编译性能** | - | {接口分离、GMF使用} |
| **依赖管理** | - | {无环、单向、清晰} |
| **测试质量** | - | {覆盖率、隔离性} |
| **代码规范** | - | {现代特性、安全性} |
| **综合评级** | **-** | **{总结}** |

### 5.2 改进计划 (Action Items)

**必须修复 (Blocker)**:
- [ ] {任务1}

**建议优化 (Nice to have)**:
- [ ] {任务2}

---
**评估人**: {姓名}
**日期**: {YYYY-MM-DD}
